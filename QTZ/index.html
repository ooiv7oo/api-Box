<!DOCTYPE html>
<html>
<head>
  <title>Force jump to QQ</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/three@0.131.2/build/three.min.js"></script>
  <style>
    /* 响应式设计 */
    @media (max-width: 768px) {
      /* 移动端样式 */
      body {
        font-size: 16px;
      }
    }
    @media (min-width: 769px) {
      /* PC 端样式 */
      body {
        font-size: 20px;
      }
    }
    #canvas{
      position:fixed;
      bottom:20%;
      left:50%;
      transform:translateX(-50%);
      width:100%;
      height:100%;
    }
  </style>
</head>
<body>
  <h1>Welcome</h1>
  <p id="device-info">This is a tip.</p>
  <canvas id="canvas"></canvas>
  
  <script>
    const isMobile = 'ontouchstart' in window;
    const deviceInfo = document.getElementById('device-info');
    deviceInfo.textContent = isMobile ? 'Your current device is a mobile device, which can be called by touching it.' : 'Your current device is on the PC side and is being called.';

    function generateProfileCard() {
      const qq = new URLSearchParams(window.location.search).get('qq');
      if (!qq) {
        alert('参数不能为空！');
        return;
      }
      const url = `mqq://card/show_pslcard?src_type=internal&source=sharecard&version=1&uin=${qq}`;
      window.location.href = url;
      setTimeout(function() {
        window.opener = null;
        window.close();
      }, 600);
    }

    function retryGenerateProfileCard(maxAttempts, delay) {
      let attempts = 0;
      function tryGenerateProfileCard() {
        attempts++;
        try {
          generateProfileCard();
          console.log('Function executed successfully!');
        } catch (error) {
          console.error('Function execution failed. Attempt #' + attempts + '. Error: ' + error.message);
          if (attempts < maxAttempts) {
            console.log('Retrying in ' + delay + ' milliseconds...');
            setTimeout(tryGenerateProfileCard, delay);
          } else {
            console.error('Max number of attempts exceeded. Giving up.');
          }
        }
      }
      tryGenerateProfileCard();
    }

    if (isMobile) {
      document.addEventListener('touchstart', function() {
        retryGenerateProfileCard(3, 1000);
      });
    } else {
      window.onload = function() {
        retryGenerateProfileCard(3, 1000);
      };
    }
    // 获取canvas元素和WebGL上下文
const canvas = document.getElementById('canvas');

// 创建场景、相机和渲染器
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, canvas.width / canvas.height, 0.1, 1000);
camera.position.z = 5;
const renderer = new THREE.WebGLRenderer({ canvas });

// 创建小球的材质和几何体
const material = new THREE.MeshBasicMaterial({ color: 0x000000 });
const geometry = new THREE.SphereGeometry(1, 32, 32);

// 创建小球的网格对象
const mesh = new THREE.Mesh(geometry, material);
scene.add(mesh);

// 定义动画循环函数
function animate(time) {
    // 计算小球表面的流动和冒泡
    const t = time * 0.001;
    const positions = mesh.geometry.attributes.position.array;
    for (let i = 0; i < positions.length; i += 3) {
        const x = positions[i];
        const y = positions[i + 1];
        const z = positions[i + 2];
        const r = Math.sqrt(x * x + y * y + z * z);
        const theta = Math.atan2(y, x);
        const phi = Math.acos(z / r);
        const dx = 0.05 * Math.sin(theta * 5 + t);
        const dy = 0.05 * Math.cos(theta * 5 + t);
        const dr = 0.05 * Math.sin(r * 5 + t);
        const u = x + dx + dr;
        const v = y + dy + dr;
        const s = 0.5 * Math.sin(u * 50 + t);
        const r2 = Math.sqrt(u * u + v * v + z * z);
        const s2 = 0.2 * Math.sin(u * 20 + v * 20 + z * 20 + t);
        positions[i] = u + s * v / r2 + s2 * u / r2;
        positions[i + 1] = v - s * u / r2 + s2 * v / r2;
        positions[i + 2] = z + s2 * z / r2;
    }
    mesh.geometry.attributes.position.needsUpdate = true;

    // 渲染场景
    renderer.render(scene, camera);

    // 启动下一帧动画
    requestAnimationFrame(animate);
}

// 启动动画循环
requestAnimationFrame(animate);
  </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
  <title>Force jump to QQ</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* 响应式设计 */
    @media (max-width: 768px) {
      /* 移动端样式 */
      body {
        font-size: 16px;
      }
    }
    @media (min-width: 769px) {
      /* PC 端样式 */
      body {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>
  <h1>Welcome</h1>
  <p id="device-info">This is a paragraph on my page.</p>
  
  <script>
    function initialize() {
      retryGenerateProfileCard(3, 1000);
      
      // 根据不同设备类型修改文本内容
      const isMobile = 'ontouchstart' in window;
      const deviceInfo = document.getElementById('device-info');
      if (isMobile) {
        deviceInfo.textContent = 'Your current device is a mobile device, which can be called by touching it.';
      } else {
        deviceInfo.textContent = 'Your current device is on the PC side and is being called.';
      }
    }
    
    // 绑定事件处理程序
    if ('ontouchstart' in window) {
      // 移动设备
      document.addEventListener('touchstart', initialize);
    } else {
      // PC 设备
      window.onload = initialize;
    }

    function generateProfileCard() {
      const qq = new URLSearchParams(window.location.search).get('qq');
      if (!qq) {
        alert('参数不能为空！');
        return;
      }
      const url = `mqq://card/show_pslcard?src_type=internal&source=sharecard&version=1&uin=${qq}`;
      window.location.href = url;
      setTimeout(function() {
        window.opener = null;
        window.close();
      }, 600);
    }

    function retryGenerateProfileCard(maxAttempts, delay) {
      let attempts = 0;
      function tryGenerateProfileCard() {
        attempts++;
        try {
          generateProfileCard();
          console.log('Function executed successfully!');
        } catch (error) {
          console.error('Function execution failed. Attempt #' + attempts + '. Error: ' + error.message);
          if (attempts < maxAttempts) {
            console.log('Retrying in ' + delay + ' milliseconds...');
            setTimeout(tryGenerateProfileCard, delay);
          } else {
            console.error('Max number of attempts exceeded. Giving up.');
          }
        }
      }
      tryGenerateProfileCard();
    }
  </script>
</body>
</html>
